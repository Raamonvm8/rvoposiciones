<div class="admin-panel">
  <h2>Usuarios registrados</h2>
    <input type="text" placeholder="Buscar por nombre..." [(ngModel)]="searchName" class="search-input">

    <table class="users-table">
      <thead>
        <tr>
          <th (click)="sortBy('email')">Email
            <span *ngIf="sortColumn==='email'">{{ sortDirection === 'asc' ? '‚¨ÜÔ∏è' : '‚¨áÔ∏è' }}</span>
          </th>
          <th>Verificado</th>
          <th (click)="sortBy('fullName')">Nombre
            <span *ngIf="sortColumn==='fullName'">{{ sortDirection === 'asc' ? '‚¨ÜÔ∏è' : '‚¨áÔ∏è' }}</span>
          </th>
          <th (click)="sortBy('createdAt')">Fecha de registro
            <span *ngIf="sortColumn==='createdAt'">{{ sortDirection === 'asc' ? '‚¨ÜÔ∏è' : '‚¨áÔ∏è' }}</span>
          </th>
          <th>Acciones</th>
        </tr>
      </thead>
    </table>
    <div class="table-scroll">
      <table class="users-table2">
        <tbody>
          <tr *ngFor="let user of filteredUsers">
            <td>{{user.email}}</td>
            <td>
              <span [class.verified]="user.emailVerified" 
                    [class.not-verified]="!user.emailVerified">
                {{ user.emailVerified ? '‚úÖ' : '‚ùå' }}
              </span>
            </td>
            <td>{{user.fullName || '‚Äî'}}</td>
            <td>{{user.createdAt | date:'medium'}}</td>
            <td>
              <button (click)="verifyUser(user.uid)" [disabled]="user.emailVerified">‚úî Verificar</button>
              <button (click)="deleteUser(user.uid)" class="danger">üóë Eliminar</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  


  <div class="admin-panel">
  <h2>Suscriptores de talleres</h2>

  <div *ngFor="let taller of talleres">
    <h3>{{ taller.titulo }}</h3>
    <table class="users-table">
      <thead>
        <tr>
          <th>Nombre</th>
          <th>Email</th>
          <th>Acceso</th>
          <th>Acciones</th>
        </tr>
      </thead>
      
      <tbody class="scroll-body">
        <tr *ngFor="let user of taller.usuarios">
          <td>{{ user.fullName || '‚Äî' }}</td>
          <td>{{ user.email }}</td>
          <td>
            <span [class.has-access]="user.hasAccess" 
                  [class.no-access]="!user.hasAccess">
              {{ user.hasAccess ? '‚úÖ' : '‚ùå' }}
            </span>
          </td>
          <td>
            <button *ngIf="user.hasAccess" (click)="revokeAccess(taller.uuid, user.email)" class="danger">
              ‚ùå Quitar acceso
            </button>
            <button *ngIf="!user.hasAccess" (click)="grantAccess(taller.uuid, user.email)">
              ‚ûï Dar acceso
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <div class="add-access">
      <input [(ngModel)]="newAccessEmail[taller.uuid]" placeholder="Correo a a√±adir">
      <button (click)="grantAccess(taller.uuid, newAccessEmail[taller.uuid])">A√±adir usuario</button>
    </div>

  </div>
</div>

</div>
